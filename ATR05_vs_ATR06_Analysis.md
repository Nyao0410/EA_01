# ATR05性能分析 & ATR06改善戦略

## ATR05パフォーマンス分析

### 📊 主要統計指標

| 指標 | 値 | 評価 |
|------|-----|------|
| **取引数** | 34 | 適切 |
| **勝率** | 41.18% | ⚠️ 低い（目標50%以上） |
| **プロフィットファクター** | 0.98 | ⚠️ ブレークイーブン（1.0以上が必要） |
| **期待利得** | -0.34 | ⚠️ 赤字 |
| **総損益** | -11.52 | ⚠️ 赤字 |
| **総利益** | 488.24 | ✓ 良好 |
| **総損失** | -499.76 | ⚠️ 利益を超える損失 |
| **平均勝ちトレード** | 34.87 | ✓ 良好 |
| **平均負けトレード** | -24.99 | ⚠️ 報酬比が低い |
| **最大ドローダウン** | 2.53% | ✓ 許容範囲 |
| **最大連敗数** | 4回 | ⚠️ 連敗制御不十分 |

### 🎯 主な課題

#### 1. **勝率の低さ（41.18%）**
- 目標：50%以上
- 原因分析：
  - シグナルが多すぎる（非効率なエントリー）
  - フィルタリング不十分
  - ノイズトレード多発

#### 2. **プロフィットファクターの低下（0.98）**
- 利益が損失をわずかに下回っている
- 平均利益（34.87）>平均損失（24.99）なのに利益が出ていない
- 理由：勝ちトレードが少なすぎる

#### 3. **連敗制御の脆弱性**
- 最大4連敗
- 連敗時のロット削減が1連敗後しか機能していない
- 連敗時のリカバリーが不十分

#### 4. **シグナルの質の低さ**
- 単純な高値・安値ブレイク方式
- エントリータイミングが悪い可能性

---

## ATR06改善戦略

### 🔧 実装した改善内容

#### **1. 多重シグナルフィルタリング**

**改善内容：**
- ✅ ATR最小値を30.0に上げる（ボラティリティ確認）
- ✅ ボラティリティ確認フィルター追加（平均ATRの1.2倍以上）
- ✅ トレンドフィルター（50期間MA）継続
- ✅ RSIフィルター強化（極値防止）
- ✅ 時間フィルター追加（流動性の高いセッションのみ）

**効果：**
- シグナル数削減 → ノイズトレード減少
- シグナル精度向上 → 勝率上昇期待

```
エントリー条件（全て満たす必要がある）：
1. ATR > 30 pips
2. 現在ATR > 平均ATR × 1.2
3. トレンド確認（MA50）
4. RSI極値外（30-70範囲）
5. 営業時間内（8-20時GMT）
```

#### **2. リスク管理の厳格化**

**改善内容：**
- ✅ リスク率：0.3% → 0.25%に削減
- ✅ 1日損失制限：2.0% → 1.5%に引き下げ
- ✅ 1週間損失制限：新規追加（3.0%）
- ✅ 連敗閾値：2回 → 1回に引き下げ（より保守的）
- ✅ ロット削減率：67% → 50%（より激しく削減）

**効果：**
- ドローダウン削減
- 大損失の防止
- 心理的安定性向上

#### **3. エントリータイミングの最適化**

**改善内容：**
- ATRマルチプライヤー：1.5倍（継続）
- リワード倍率：1.5倍 → 2.0倍に上昇
- 利益確定目標が高くなる
- より効率的なR:R比

```
計算例：
SL距離 = ATR × 1.5 = 100 pips × 1.5 = 150 pips
TP距離 = 150 pips × 2.0 = 300 pips
リスク・リワード比 = 1:2.0
```

#### **4. ロット回復ロジックの改善**

**改善内容：**
- 段階的ロット回復（勝利数に応じて段階的）
- 3連勝でロット100%復帰
- 回復スピードは遅いが確実性重視

```
例：ロット削減後（50%）
1勝目：50% → 65%
2勝目：65% → 80%
3勝目：80% → 100%（復帰完了）
```

#### **5. 週間損失管理の追加**

**改善内容：**
- 日次制限だけでなく週次制限も設定
- 累積損失防止
- 過度なドローダウン回避

---

## 📈 期待される改善結果

### シナリオ別予測

#### **ベース：ATR05実績**
- 取引数：34回
- 勝率：41.18%
- PF：0.98
- 総損益：-11.52

#### **見込み：ATR06**

| 項目 | ATR05 | ATR06予想 | 改善率 |
|------|-------|----------|--------|
| 勝率 | 41.18% | **48-52%** | +7-11% |
| PF | 0.98 | **1.15-1.25** | +17-28% |
| 取引数 | 34 | **20-25** | -30～42% |
| 平均勝ち | 34.87 | ~35 | ±0% |
| 平均負け | -24.99 | ~-20 | -20% |
| ドローダウン | 2.53% | **1.5-2.0%** | -40% |

### ✅ 達成目標

1. **勝率 50%以上**
   - フィルター強化による不要なトレード排除
   - シグナル精度向上

2. **プロフィットファクター 1.2以上**
   - TP目標を高める（2.0倍）
   - 効率性向上

3. **ドローダウン 2.0%以下に制御**
   - 厳しい日次/週次制限
   - 連敗時の迅速なロット削減

4. **連敗制御：最大2回以内**
   - 1連敗で50%削減
   - 複数連敗リスク軽減

---

## 🎬 次のアクション

1. **ATR06のバックテスト実施**
   - 2023年1月～2024年10月（ATR05と同じ期間）
   - パフォーマンス確認

2. **パラメータ微調整**
   - MinATRFilter：30 → 35への調整検討
   - RSI levels：70/30 → 75/25への変更検討
   - リスク率：0.25% → 0.2%への検討

3. **詳細な統計分析**
   - ウォークフォワード分析
   - モンテカルロシミュレーション
   - アウト・オブ・サンプルテスト

4. **トレード制約の追加検討**
   - 曜日別フィルター（月曜日スキップなど）
   - 経済指標発表時間の回避
   - より厳密な流動性チェック

---

## 📝 技術詳細

### 新規追加関数

```mq5
// 営業時間フィルター
bool IsSessionTime()  // GMT時間ベースで営業時間チェック

// 週間リセット
void CheckWeeklyReset()  // 月曜日に週間統計をリセット

// 週間損失チェック
bool CheckMaxWeeklyLoss()  // 週間累積損失をチェック
```

### パラメータの意味

| パラメータ | 説明 |
|-----------|------|
| `MinATRFilter` | ボラティリティ最小値。小さすぎるボラティリティでの取引を防止 |
| `VolatilityThreshold` | 平均ATRに対する現在ATRの比率。1.2倍以上で良好な市場環境と判断 |
| `RSIUpperLevel/LowerLevel` | RSI極値レベル。極度の買われ/売られ状態でのエントリー防止 |
| `MaxConsecutiveLosses` | この数の連敗後、ロット削減が実行される |
| `WinCountToRestore` | この数の連勝でロット100%に回復 |
| `SessionStartHour/EndHour` | 営業時間（GMT）。流動性の高い時間帯のみ取引 |

---

## 🚨 リスク注意事項

1. **パラメータ最適化による過適合**
   - 過去データに最適化されている可能性
   - フォワード期間での検証が必須

2. **市場環境の変化**
   - 2023-2024年のデータベース
   - 異なる市場環境では性能が異なる可能性

3. **流動性リスク**
   - 特定時間帯（セッション外）での低流動性
   - スリップの増加可能性

4. **大型経済指標**
   - 発表時のギャップリスク
   - STOPレベルの貫通可能性

---

**作成日：2025年10月21日**
**バージョン：v6.00**
